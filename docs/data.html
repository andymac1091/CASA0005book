<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Data | CASA0005 Geographic Information Systems and Science</title>
  <meta name="description" content="Chapter 5 Data | CASA0005 Geographic Information Systems and Science" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Data | CASA0005 Geographic Information Systems and Science" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Data | CASA0005 Geographic Information Systems and Science" />
  
  
  

<meta name="author" content="Andy MacLachlan and Adam Dennett" />


<meta name="date" content="2019-06-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-basics-of-geographic-information.html">
<link rel="next" href="data-sources-and-task.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CASA0005</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-world-of-gis"><i class="fa fa-check"></i><b>1.1</b> The world of GIS</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting Started</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#offline-viewing"><i class="fa fa-check"></i><b>1.3</b> Offline viewing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="learning-outcomes.html"><a href="learning-outcomes.html"><i class="fa fa-check"></i><b>3</b> Learning outcomes</a></li>
<li class="chapter" data-level="4" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html"><i class="fa fa-check"></i><b>4</b> The Basics of Geographic Information</a><ul>
<li class="chapter" data-level="4.1" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#important-gis-data-formats"><i class="fa fa-check"></i><b>4.1</b> Important GIS data formats</a><ul>
<li class="chapter" data-level="4.1.1" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#shapefiles"><i class="fa fa-check"></i><b>4.1.1</b> Shapefiles</a></li>
<li class="chapter" data-level="4.1.2" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#geojson"><i class="fa fa-check"></i><b>4.1.2</b> GeoJSON</a></li>
<li class="chapter" data-level="4.1.3" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#shapefile-and-geojson"><i class="fa fa-check"></i><b>4.1.3</b> Shapefile and GeoJSON</a></li>
<li class="chapter" data-level="4.1.4" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#raster-data"><i class="fa fa-check"></i><b>4.1.4</b> Raster data</a></li>
<li class="chapter" data-level="4.1.5" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#other-data-formats"><i class="fa fa-check"></i><b>4.1.5</b> Other data formats</a></li>
<li class="chapter" data-level="4.1.6" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#geodatabase"><i class="fa fa-check"></i><b>4.1.6</b> Geodatabase</a></li>
<li class="chapter" data-level="4.1.7" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#geopackage"><i class="fa fa-check"></i><b>4.1.7</b> GeoPackage</a></li>
<li class="chapter" data-level="4.1.8" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#spatialite"><i class="fa fa-check"></i><b>4.1.8</b> SpatiaLite</a></li>
<li class="chapter" data-level="4.1.9" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#postgis"><i class="fa fa-check"></i><b>4.1.9</b> PostGIS</a></li>
<li class="chapter" data-level="4.1.10" data-path="the-basics-of-geographic-information.html"><a href="the-basics-of-geographic-information.html#what-will-i-use"><i class="fa fa-check"></i><b>4.1.10</b> What will I use</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Data</a><ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#file-paths"><i class="fa fa-check"></i><b>5.1</b> File paths</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#data-download"><i class="fa fa-check"></i><b>5.2</b> Data download</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#data-pre-processing"><i class="fa fa-check"></i><b>5.3</b> Data pre-processing</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#data-loading"><i class="fa fa-check"></i><b>5.4</b> Data loading</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#arcgis"><i class="fa fa-check"></i><b>5.5</b> ArcGIS</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data.html"><a href="data.html#basics"><i class="fa fa-check"></i><b>5.5.1</b> Basics</a></li>
<li class="chapter" data-level="5.5.2" data-path="data.html"><a href="data.html#arccatalog"><i class="fa fa-check"></i><b>5.5.2</b> ArcCatalog</a></li>
<li class="chapter" data-level="5.5.3" data-path="data.html"><a href="data.html#arcmap"><i class="fa fa-check"></i><b>5.5.3</b> ArcMap</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#qgis"><i class="fa fa-check"></i><b>5.6</b> QGIS</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#introduction-1"><i class="fa fa-check"></i><b>5.6.1</b> Introduction</a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#load-data-1"><i class="fa fa-check"></i><b>5.6.2</b> Load data</a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#join-data-1"><i class="fa fa-check"></i><b>5.6.3</b> Join data</a></li>
<li class="chapter" data-level="5.6.4" data-path="data.html"><a href="data.html#export-data-1"><i class="fa fa-check"></i><b>5.6.4</b> Export data</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#r"><i class="fa fa-check"></i><b>5.7</b> R</a><ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#introduction-2"><i class="fa fa-check"></i><b>5.7.1</b> Introduction</a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#load-data-2"><i class="fa fa-check"></i><b>5.7.2</b> Load data</a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#join-data-2"><i class="fa fa-check"></i><b>5.7.3</b> Join data</a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#export-data-2"><i class="fa fa-check"></i><b>5.7.4</b> Export data</a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#making-a-script"><i class="fa fa-check"></i><b>5.7.5</b> Making a script</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#what-will-i-use-1"><i class="fa fa-check"></i><b>5.8</b> What will I use</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html"><i class="fa fa-check"></i><b>6</b> Data sources and task</a><ul>
<li class="chapter" data-level="6.1" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#uk-data-service"><i class="fa fa-check"></i><b>6.1</b> UK Data Service</a></li>
<li class="chapter" data-level="6.2" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#ons"><i class="fa fa-check"></i><b>6.2</b> ONS</a></li>
<li class="chapter" data-level="6.3" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#os"><i class="fa fa-check"></i><b>6.3</b> OS</a></li>
<li class="chapter" data-level="6.4" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#edina-digimap"><i class="fa fa-check"></i><b>6.4</b> Edina Digimap</a></li>
<li class="chapter" data-level="6.5" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#osm"><i class="fa fa-check"></i><b>6.5</b> OSM</a></li>
<li class="chapter" data-level="6.6" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#defra"><i class="fa fa-check"></i><b>6.6</b> DEFRA</a></li>
<li class="chapter" data-level="6.7" data-path="data-sources-and-task.html"><a href="data-sources-and-task.html#data-lists"><i class="fa fa-check"></i><b>6.7</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>7</b> Summary</a></li>
<li class="chapter" data-level="8" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>8</b> Literature</a></li>
<li class="chapter" data-level="9" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>9</b> Methods</a></li>
<li class="chapter" data-level="10" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>10</b> Applications</a><ul>
<li class="chapter" data-level="10.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>10.1</b> Example one</a></li>
<li class="chapter" data-level="10.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>10.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>11</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CASA0005 Geographic Information Systems and Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Data</h1>
<p>The volume of geographic information which is freely available for use in the UK is increasing exponentially and spatially referenced data can often be found in many different places. In this practical we’re going to use data from the London data store — a free and open data-sharing portal provided by the Greater London Authrotiy (GLA), also known as City Hall that is the devovled regional governance body of London.</p>
<p>We are going to get spatial data of the London boroughs and join flytipping (the illegal deposit of waste, commonly on road verges) data that is provided as a <code>.csv</code> file. <code>.csv</code> stands for comma-separated values (CSV) — it uses a comma to separate each value.</p>
<p>At the end of this document I’ll also run through some common sources of data that will stand you in good stead (be advantagous) for the rest of the course.</p>
<div id="file-paths" class="section level2">
<h2><span class="header-section-number">5.1</span> File paths</h2>
<p>In your N drive: create a new folder called GIS and within this a subfolder called wk1. It is up to you how you organise your files. Make sure you change the file paths within where appropraite to your own.</p>
</div>
<div id="data-download" class="section level2">
<h2><span class="header-section-number">5.2</span> Data download</h2>
<p>Firstly we need to get a spatial outline of the London boroughs. The geographic boundaries that are used in the UK are a complex, often inter-related, but ever changing mass of areas. For anyone new to the UK (or indeed not a trained quantitative geographer), it can be quite a daunting task to attempt to understand all of the boundaries that are in use. Fortunately the Office for National Statistics (ONS) has an online beginners guide to UK geography. If you need more information on the vast array of different UK geographies, this is the place to start: <a href="http://geoportal.statistics.gov.uk/datasets/a-beginners-guide-to-uk-geography-2018-v1-0" class="uri">http://geoportal.statistics.gov.uk/datasets/a-beginners-guide-to-uk-geography-2018-v1-0</a></p>
<ul>
<li>Spatial Data</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>To get the data go to: <a href="https://data.london.gov.uk/" class="uri">https://data.london.gov.uk/</a></p></li>
<li><p>Seach for Statistical GIS Boundary Files for London</p></li>
<li><p>Download the statistical-gis-boundaries-london.zip</p></li>
<li><p>Unzip the data and save it to your wk1 folder.</p></li>
</ol>
<ul>
<li>CSV data</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>On the same website search for fly-tipping incidents</p></li>
<li><p>Download the <code>.csv</code> file</p></li>
</ol>
</div>
<div id="data-pre-processing" class="section level2">
<h2><span class="header-section-number">5.3</span> Data pre-processing</h2>
<p><strong>Question</strong> Open the <code>.csv</code> in Excel, what do you notice about how the data is stored?</p>
<p><strong>Answer</strong> The year is a column and for each area the values are repeated for different years. In our analysis it is easier to have the different years as a coloumn and populated for each area. So, we want to go from this…</p>
<p><img src="prac1_images/csv_original.png" width="600px" style="display: block; margin: auto;" /></p>
<p>To this…</p>
<p><img src="prac1_images/csv_pivot.png" width="600px" style="display: block; margin: auto;" /></p>
<p>As we are going to use this dataset in ArcMap, QGIS and R I’ve done it in Excel using a pivot table.</p>
<ol style="list-style-type: decimal">
<li><p>Go to Insert &gt; PivotTable</p></li>
<li><p>Select the original table and create a PivotTable in a new worksheet</p></li>
<li><p>The PivotTable Field box will appear, experiment with the different fields in each of the areas</p></li>
</ol>
<p>I’ve used the following:</p>
<p><img src="prac1_images/pivot_example.png" width="200px" style="display: block; margin: auto;" />
Note how I’ve altered the total_action_taken to the sum of… as the original was displaying incorrectly, to do so:</p>
<ol style="list-style-type: decimal">
<li>Click on drop down button for total_action_taken &gt; Value Field Settings &gt; select Count</li>
</ol>
<p>It’s important to think about what data we actually need in the next step and it’s good practice to avoid data redundancy where possible.</p>
<p><strong>Spoiler</strong> The spatial data we have downloaded already contains borough name, so we don’t need it twice. However, we do need a field to link the two datasets on. You could use borough name, but when using text fields sometimes input variations can affect joins. For example, you had the University of Manchester in one dataset and Manchester University in another the join would fail. Consequntly it’s usually best to join datsets on a code field.</p>
<p>Now save the Excel sheet that contains the pivot table as a new <code>.csv</code>. Make sure that the first row of data holds the coloumn titles. Remove all empty rows.</p>
<p>When saving the file also avoid any special characters (e.g. -) and spaces, use an underscore instead of spaces.</p>
<p><strong>Warning</strong> Spatial software (especially ArcGIS) does not like file names with spaces or special characters.</p>
</div>
<div id="data-loading" class="section level2">
<h2><span class="header-section-number">5.4</span> Data loading</h2>
<p>Now it’s time to load, inspect and do some basic manipulation of this data. As mentioned in the lecture there are several GIS software ‘types’, here we will repeat the same process across ArcGIS, QGIS and R. Each system has specific benefits, but in general there has been a recent shift towards the use of QGIS and R, both being opensource. ArcGIS was the first major spatial analysis software produced by the Environmental Systems Research Institute, Inc. (Esri), founded in 1969 by Jack Dangermond. Due to its high cost and lack of customisation it is now less commonly used within the research community.</p>
<p><img src="prac1_images/ArcGISvsQGIS.png" width="300px" style="display: block; margin: auto;" /></p>
</div>
<div id="arcgis" class="section level2">
<h2><span class="header-section-number">5.5</span> ArcGIS</h2>
<div id="basics" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Basics</h3>
<p>ArcGIS should be installed as a standard programme in the UCL desktop and you can navigate to it from the Windows start button.</p>
<div id="installing-arcgis-on-your-own-computer" class="section level4">
<h4><span class="header-section-number">5.5.1.1</span> Installing ArcGIS on your own computer</h4>
<p>As a UCL student, you can install ArcGIS on your own computer. This is easy if you have a PC, but if you have a Mac this can be trickier as Arc will only run in a PC environment. If you have a Mac, the options open to you are either to:</p>
<ol style="list-style-type: lower-alpha">
<li>Run ArcGIS through the <a href="mailto:Desktop@UCL" class="email">Desktop@UCL</a> application - <a href="http://www.ucl.ac.uk/isd/services/computers/remote-access/desktop" class="uri">http://www.ucl.ac.uk/isd/services/computers/remote-access/desktop</a></li>
<li>Duel boot your machine using bootcamp, install Windows (7 or 8 is fine) and then install Arc onto the Windows partition.</li>
<li>Install some kind of virtualisation software such as Parallels (<a href="http://www.parallels.com/ca/products/desktop/" class="uri">http://www.parallels.com/ca/products/desktop/</a>) or VMware (<a href="http://www.vmware.com/products/fusion/" class="uri">http://www.vmware.com/products/fusion/</a>), and run Arc on a virtual windows machine</li>
</ol>
<p>If you can, it is preferable to run Arc on Bootcamp as virtualisation software can be slow, but the <a href="mailto:Desktop@UCL" class="email">Desktop@UCL</a> facility should suffice for this course.
ArcGIS (Version 10.6 is the latest at time of writing, but may have already been superseded) can be downloaded from the UCL Software Database for free — <a href="https://swdb.ucl.ac.uk/" class="uri">https://swdb.ucl.ac.uk/</a>.</p>
</div>
<div id="getting-help" class="section level4">
<h4><span class="header-section-number">5.5.1.2</span> Getting Help</h4>
<p>ArcGIS is a huge and complex piece of software, but thankfully is has an excellent help system – depending on the version you are using (they are all quite similar anyway) you can access the online help system here:</p>
<ul>
<li><p><a href="http://resources.arcgis.com/en/help/main/10.2/" class="uri">http://resources.arcgis.com/en/help/main/10.2/</a></p></li>
<li><p><a href="http://resources.arcgis.com/en/help/main/10.1/" class="uri">http://resources.arcgis.com/en/help/main/10.1/</a></p></li>
</ul>
</div>
<div id="arcgis-1" class="section level4">
<h4><span class="header-section-number">5.5.1.3</span> ArcGIS</h4>
<p>ArcGIS is actually a whole suite of software built and maintained by ESRI (<a href="http://www.esri.com/software/arcgis" class="uri">http://www.esri.com/software/arcgis</a>).Within the ArcGIS for Desktop suite you will find the following programmes:</p>
<ul>
<li><p><strong>ArcCatalog — Similar to Windows Explorer, ArcCatalog allows you to manage your GIS files, folders and geodatabases</strong></p></li>
<li><p>ArcGIS Administrator — This programme us used to manage licences for the various elements of ArcGIS</p></li>
<li><p>ArcGlobe — ArcGlobe allows you to view and analyse your data in 3D –– this interface looks very similar to Google Earth and is part of the 3D analyst extension</p></li>
<li><p><strong>ArcMap — This is the programme you will use most often –– it is the main mapping and spatial analysis element of ArcGIS</strong></p></li>
<li><p>ArcScene — ArcScene is a 3D viewer which allows you to navigate and interact with your 3D raster and feature data</p></li>
</ul>
<p>ArcCatalog and ArcMap are in bold as these are the only programmes we will be using explicitly in this course. By all means experiment with the others if you have any spare time!</p>
</div>
</div>
<div id="arccatalog" class="section level3">
<h3><span class="header-section-number">5.5.2</span> ArcCatalog</h3>
<ul>
<li><p>Find and run the ArcCatalog piece of software</p></li>
<li><p>Once ArcCatalog Opens, go to File &gt; Connect To Folder… and navigate to the N:folder, right click in the contents area and create a new Flie Geodatabase.</p></li>
</ul>
<p><img src="prac1_images/file_geo.png" width="500px" style="display: block; margin: auto;" /></p>
<p>You can import data layers into a Geodatabase within ArCatalog, however we will do this in ArcMap.</p>
<p>Close ArcCatalog and never have both ArcCatalog and another ArcGIS product open at the same time.</p>
</div>
<div id="arcmap" class="section level3">
<h3><span class="header-section-number">5.5.3</span> ArcMap</h3>
<div id="introduction" class="section level4">
<h4><span class="header-section-number">5.5.3.1</span> Introduction</h4>
<p>ArcMap is the core of the ArcGIS suite and where you would normally produce maps, carry out spatial analysis functions and automate processes.</p>
<ol style="list-style-type: decimal">
<li>Search for and open ArcMap</li>
<li>Upon opening select the database you just created in the dialogue box</li>
<li>Click ok</li>
</ol>
<p><img src="prac1_images/default_database.png" width="800px" style="display: block; margin: auto;" /></p>
<p>When the map document opens you should see something similar to the image below, highlighting some of the key buttons:</p>
<p><img src="prac1_images/arcmap.png" width="500px" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>It’s important to now set the map document up properly. Go File &gt; Map Document Properties, enter the details you wish. You can see the connection to the Geodatabase we just made. Click store relative pathnames, this means as long as the data stays in the same position relative to the path then ArcMap can load all the layers. For example if you moved your work from the C: drive to an external drive, H:.</li>
</ol>
</div>
<div id="load-data" class="section level4">
<h4><span class="header-section-number">5.5.3.2</span> Load data</h4>
<ol start="5" style="list-style-type: decimal">
<li>Using the <strong>Plus</strong> icon (add data layer) navigate to the extracted folder you saved earlier.</li>
<li>Open London_Borough_Excluding_MHW.shp, but feel free to explore the other data layers. In the left hand Table Of Contents you can unselect layers to turn them off or drag layers above or below to change the display order. In the example below the wards layer is showing above the borough layer.</li>
</ol>
<p><img src="prac1_images/display_order.png" width="800px" style="display: block; margin: auto;" /></p>
<p><strong>Note</strong>, while we have loaded the shapefile, it is not stored in our Geodatabase yet.</p>
<p><strong>Useful tips</strong></p>
<ul>
<li><p>To the right of the document you will see the Catalog and Search tabs.The Catalog tab is a more compact version of ArcCatalog and will let you see what data is stored in the current Geodatabase. The search tab will let you find any analysis tool within ArcGIS. Try searching for Clip.</p></li>
<li><p>If you right click on the boroughs layer (in the Table of Contents, left hand pane) you will see various options. Zoom to layer is very useful if you ever get lost in your ArcMap document.</p></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Now right click on the borough layer (in the Table of Contents) and open the attribute table. You’ll see the GSS_CODE field, which is the same code we output in our <code>.csv</code>. If you now right click on a field you’ll also be able to see the data type (e.g. string, integer). For example:</li>
</ol>
<p><img src="prac1_images/London_attribute_table.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="join-data" class="section level4">
<h4><span class="header-section-number">5.5.3.3</span> Join data</h4>
<p>We’re now going to join our flytipping data to the lonon borough shapefile. So:</p>
<ol start="8" style="list-style-type: decimal">
<li>Right click on the london borough layer &gt; Joins and Relates &gt; Join<br />
</li>
<li>Select the GSS_CODE as the field in the layer to base the join on</li>
<li>Navigate to the <code>.csv</code> we created earlier</li>
<li>Select the code field that matches (in my case this is called Row Labels)</li>
<li>Select only to join matching records</li>
<li>Validate join and click OK</li>
</ol>
<p><strong>You will get errors</strong>, ArcMap does not like fields starting with numbers (e.g. 2012), dashes (e.g. -) or spaces. Feel free to change them in the original <code>.csv</code> but for this practical it is fine to continue.</p>
<ol start="14" style="list-style-type: decimal">
<li>The join should work, so reopen the attribute table for the layer London boroughs</li>
</ol>
<p><strong>Note</strong>, the join we have made is not permanent. To do so we need to export the layer.</p>
</div>
<div id="export-data" class="section level4">
<h4><span class="header-section-number">5.5.3.4</span> Export data</h4>
<ol start="15" style="list-style-type: decimal">
<li>Right click on the london boroughs layer &gt; Data &gt; Export Data</li>
<li>The location should default to our GeoDatabase. Be sure to change the filename — again avoid all of the characters (e.g. spaces and -) previously mentioned. Add the data layer to the map</li>
</ol>
<p>Now lets use the data we’ve joined to create a basic thematic map.</p>
<ol start="17" style="list-style-type: decimal">
<li>Right click on the new London borough layer &gt; Properties</li>
<li>Under the Symbology tab select Graduated colors</li>
<li>Select the Value as one of the years of data we joined and change the classificaiton to something of your choice</li>
</ol>
<p><img src="prac1_images/symbology.png" width="800px" style="display: block; margin: auto;" /></p>
<p>You should have something that looks like this:</p>
<p><img src="prac1_images/thematicmap.png" width="800px" style="display: block; margin: auto;" /></p>
<p><strong>We haven’t talked about the Coordiante Reference System (CRS) (or Spatial Reference System (SRS)) of our map document</strong></p>
<p>A coordinate reference system is a series of paramters that define the coordinate system. Within GIS we use geographic or projected cooridnate systems. The former uses a three-dimesional spherical surface to define locations of Earth, whereas the latter is defined on a flat, two-dimesional surface giving it constat lengths, angles and areas.</p>
<p>In ArcMap we can specify what CRS we want to use by:</p>
<ol start="20" style="list-style-type: decimal">
<li>Right clicking on the map document &gt; Data Frame Properties</li>
</ol>
<p>You’ll see that it is already set to Projected Coordinate Systems, National Grids, Europe, British National Grid. This is because ArcMap will default to the cooridnate system of the first data layer loaded.</p>
<p><img src="prac1_images/coorindate_system.png" width="300px" style="display: block; margin: auto;" /></p>
<p>Save and then close your ArcMap document. We’re now going to replicate this task in QGIS.</p>
<p><strong><em>Note</em></strong> As we are going to open the same files in difference GIS systems it is important to close the software before moving on. If you don’t then files can be <em>locked</em> and unreadable as they are still considered to be in use.</p>
</div>
</div>
</div>
<div id="qgis" class="section level2">
<h2><span class="header-section-number">5.6</span> QGIS</h2>
<div id="introduction-1" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Introduction</h3>
<p>QGIS is very similar to ArcMap except that as it is open-source and free there are many add on packages that (or plugins) that provide additional functionality to the software.</p>
<p>To get QGIS on your personal machine go to: <a href="https://qgis.org/en/site/forusers/download.html" class="uri">https://qgis.org/en/site/forusers/download.html</a></p>
<p>I install the OSGeo4W version. The nature of open-source means that several programs will rely on each other for features. OSGeo4W tracks all the shared requirements and does not intall any duplicates.</p>
</div>
<div id="load-data-1" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Load data</h3>
<ol style="list-style-type: decimal">
<li>Search for and open QGIS</li>
<li>Click on the open data source manager. Just above the word <em>browser</em> in the top left of the screen</li>
</ol>
<p><img src="prac1_images/qgis_datamanager.png" width="700px" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Navigate to the London boroughs layer <code>.shp</code> and add it, you then have to close the data source manager</li>
</ol>
<p>Just like in ArcMap you can right click on the layer to view the attribute table. Unlike ArcMap you have to load the <code>.csv</code> file into QGIS in order to join it to a shapefile.</p>
<ol start="4" style="list-style-type: decimal">
<li>Open the data source manager and select Delimited Text</li>
<li>Navigate to our <code>.csv</code> file and provide a suitable layer name</li>
<li>Under Record and Fields Options make sure the number of header lines to discard is 0 and the First record has field names box is selected (this is assuming you left a title for each coloumn in your <code>.csv</code>)</li>
<li>Under Geometry Definition select No geometry (attribute table only)</li>
</ol>
<p><img src="prac1_images/csv_datamanager.png" width="700px" style="display: block; margin: auto;" /></p>
<p>Does the sample data seem right?</p>
<ol start="8" style="list-style-type: decimal">
<li>If so, click add then close</li>
</ol>
</div>
<div id="join-data-1" class="section level3">
<h3><span class="header-section-number">5.6.3</span> Join data</h3>
<ol start="9" style="list-style-type: decimal">
<li>Right click on the London boroughs layer &gt; Properties &gt; Joins</li>
<li>Click the plus button at the bottom of the box</li>
<li>Complete the dialouge box</li>
</ol>
<p><img src="prac1_images/qgis_join.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="export-data-1" class="section level3">
<h3><span class="header-section-number">5.6.4</span> Export data</h3>
<p>Now instead of using a GeoDatabase, let’s export to a GeoPackage.</p>
<ol start="12" style="list-style-type: decimal">
<li>Right click on the London boroughs layer &gt; Export &gt; Save Feautre As</li>
<li>Select the GeoPackage format and complete the File name (the saved file name for the GeoPackage) and the Layer name (the name for this layer within the GeoPackage). Recall that a GeoPackage can store many data layers as a single file</li>
<li>The new layer will be added to the map, so you can remove the old one. Make sure you remove the right one</li>
</ol>
<p><img src="prac1_images/make_geopkg.png" width="500px" style="display: block; margin: auto;" /></p>
<p>We’ve now made a GeoPackage that we can connect our map project to.</p>
<ol start="15" style="list-style-type: decimal">
<li>Under <em>Browser</em>, Right click on GeoPackage &gt; New Connection &gt; Navigate to your GeoPackage</li>
<li>Click the down arrow left to GeoPackage and you should see the one you just navigated to. Click the down arrow on the database and you can see your layer.</li>
<li>Now we are going to import our <code>.csv</code> into our GeoPackage. To do so go: Database &gt; DB Manager</li>
<li>Select your GeoPackage in the left hand pane</li>
<li>Import layer/file then select the <code>.csv</code>. Click Ok.</li>
</ol>
<p>Again, remember that the <code>.csv</code> in the Layers tab (bottom left) is the original. Remove it, then from the GeoPackage just click, hold and drag the <code>.csv</code> into the layer pane.</p>
<p>Now let’s make a quick thematic map like we did in ArcMap.</p>
<ol start="20" style="list-style-type: decimal">
<li>Right click on your London boroughs layer &gt; Properties &gt; Symbology</li>
<li>Select categorised and choose a data coloumn and color ramp</li>
</ol>
<p>You could also select graduated, however our joined data fields are in the wrong data type. If you wish to change them follow this guide: <a href="https://wiki.tuflow.com/index.php?title=QGIS_Change_Attribute_Type" class="uri">https://wiki.tuflow.com/index.php?title=QGIS_Change_Attribute_Type</a></p>
<ol start="22" style="list-style-type: decimal">
<li>Save your QGIS project</li>
</ol>
<p>You should have produced something like this:</p>
<p><img src="prac1_images/QGIS_final.png" width="800px" style="display: block; margin: auto;" /></p>
<p><strong>Spatial reference</strong></p>
<p>QGIS is similar but different to ArcMap. QGIS defaults to the Coordiante Reference System (CRS) WGS 84, or known by its European Petroleum Survey Group (EPSG) code 4326. However, when you add your first layer in will default to that CRS. We’ll go into the background of EPSG next time.</p>
<p>You can change the CRS by going File &gt; Properties and selecting CRS in the left hand pane.</p>
</div>
</div>
<div id="r" class="section level2">
<h2><span class="header-section-number">5.7</span> R</h2>
<div id="introduction-2" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Introduction</h3>
<p>R is both a programming language and software environment, originally designed for statistical computing and graphics. R’s great strength is that it is open-source, can be used on any computer operating system and free for anyone to use and contribute to. Because of this, it is rapidly becoming the statistical language of choice for many academics and has a huge user community with people constantly contributing new packages to carry out all manner of statistical, graphical and importantly for us, geographical tasks.</p>
<p>The purpose of this practical is just to demostrate data loading and manipulation in different software. The next practical will provide much more detail on R, so don’t worry.</p>
<p>Search for and open R Studio.</p>
<p>You can install R Studio on your own machine from: <a href="https://www.rstudio.com/products/rstudio/download/#download" class="uri">https://www.rstudio.com/products/rstudio/download/#download</a></p>
<p>R studio requires R which you can download from: <a href="https://cran.rstudio.com/" class="uri">https://cran.rstudio.com/</a></p>
<p>RStudio is a free and open-source integrated development envrionment for R — it makes R much easier to use.</p>
<p>In RStduio go:</p>
<ol style="list-style-type: decimal">
<li>File &gt; New File &gt; R Script</li>
</ol>
<p>You should be able to see these quadrants:</p>
<p><img src="prac1_images/RStudio.png" width="800px" style="display: block; margin: auto;" /></p>
<p>Below are bits of code, to start we will work using the <strong>console</strong>. So just copy the bits of code into the console window, changing the file names to where your data is stored. Then at the end of this section I’ll show you how to make a script.</p>
<p>R works on packages that are collections of functions and data. For this practical we will need the ones listed in the code chunk below. Whilst we’ve installed them, we haven’t yet loaded them. It’s best practice to do all this at the start of your code, however, for demonstration purpoposes I’ll load each one as we need it.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;sf&quot;</span>, <span class="st">&quot;tmap&quot;</span>, <span class="st">&quot;tmaptools&quot;</span>, <span class="st">&quot;RSQLite&quot;</span>, <span class="dt">repos =</span> <span class="st">&quot;https://www.stats.bris.ac.uk/R/&quot;</span>)</code></pre>
<p>Packages we’ve installed:</p>
<ul>
<li>sf: simple features, standad way to encode spatial vector data</li>
<li>tmap: layer-based and easy approach to make thematic maps</li>
<li>tmaptools: set of tools for reading and processing spatial data</li>
<li>RSQLite: embeds the SQLite database engine in R</li>
</ul>
<p>Here, repos stands for repository where we will download the packages from.</p>
</div>
<div id="load-data-2" class="section level3">
<h3><span class="header-section-number">5.7.2</span> Load data</h3>
<p>Great, load the sf package so we can read our shapefile in — remember to change to filepath to your shapefile.</p>
<p><strong><em>Note</em></strong> by default in R, the file path should be defined with / but on a #windows file system it is defined with . Using \ instead allows R #to read the path correctly – alternatively, just use /</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
shape &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;Prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>)</code></pre>
<pre><code>## Reading layer `London_Borough_Excluding_MHW&#39; from data source `N:\Documents\Teaching\CASA0005practicals\CASA0005book\Prac1_data\statistical-gis-boundaries-london\ESRI\London_Borough_Excluding_MHW.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 33 features and 7 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs</code></pre>
<p>To get a summary of the data held within the shapefile data (attribute table) enter the following:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(shape)</code></pre>
<pre><code>##                    NAME         GSS_CODE     HECTARES      
##  Barking and Dagenham: 1   E09000001: 1   Min.   :  314.9  
##  Barnet              : 1   E09000002: 1   1st Qu.: 2724.9  
##  Bexley              : 1   E09000003: 1   Median : 3857.8  
##  Brent               : 1   E09000004: 1   Mean   : 4832.4  
##  Bromley             : 1   E09000005: 1   3rd Qu.: 5658.5  
##  Camden              : 1   E09000006: 1   Max.   :15013.5  
##  (Other)             :27   (Other)  :27                    
##    NONLD_AREA     ONS_INNER SUB_2009  SUB_2006           geometry 
##  Min.   :  0.00   F:19      NA&#39;s:33   NA&#39;s:33   MULTIPOLYGON :33  
##  1st Qu.:  0.00   T:14                          epsg:NA      : 0  
##  Median :  2.30                                 +proj=tmer...: 0  
##  Mean   : 64.22                                                   
##  3rd Qu.: 95.60                                                   
##  Max.   :370.62                                                   
## </code></pre>
<p>To have a quick look what the shapefile looks like enter the following:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(shape)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>From what we did in QGIS and ArcMap this should look familiar.</p>
<p>We now need to load our <code>.csv</code> file:</p>
<pre class="sourceCode r"><code class="sourceCode r">mycsv &lt;-<span class="st">  </span><span class="kw">read.csv</span>(<span class="st">&quot;Prac1_data/fly_tipping_borough_edit.csv&quot;</span>)  </code></pre>
<p>To view the data just input:</p>
<pre class="sourceCode r"><code class="sourceCode r">mycsv </code></pre>
<pre><code>##     Row.Labels X2011_12 X2012_13 X2013_14 X2014_15 X2015_16 X2016_17
## 1    E09000001      563     1492      433      347      587     1944
## 2    E09000002     2687     2122     1399     3100     2672     1130
## 3    E09000003     2356     1828      890      219      615      130
## 4    E09000004      505      627      732      399      262      439
## 5    E09000005     6713     2232     3189     3926     3980     4366
## 6    E09000006      306      479      653      462      326      228
## 7    E09000007     5541     5962     8281     4837     4719     4656
## 8    E09000008       31      108      460      712     1707      637
## 9    E09000009     6727     5679     6543     5521     6067    12688
## 10   E09000010     7262     3595     3269     4937     5292    10894
## 11   E09000011     6344     7482    13950    17667     6410     2188
## 12   E09000012     2332     1456    10495     8865     9494     5601
## 13   E09000013     6944     1719     1719     1632     1868     4857
## 14   E09000014     8817     4719     7633     8639     3615     5131
## 15   E09000015     1053        0        0      995     1354     1385
## 16   E09000016    13970    13762    13393     7404     8523    11748
## 17   E09000017     5120     4188     3101        0      620     3031
## 18   E09000018     1234     1030      994     2190     1865     2242
## 19   E09000019     6959     6167     8646     8172     8250     7878
## 20   E09000020     4773     5009     6353     6651     6308     9282
## 21   E09000021        0        0        0        0        0        0
## 22   E09000022      598        0        0        0        0        0
## 23   E09000023      789     1083     1499     2627     2611     1454
## 24   E09000024     1279     1299     1305     6985     2542     6056
## 25   E09000025     9593     7283    10354     8620    10621     5155
## 26   E09000026     6114     6913     4778     6306     4319     2489
## 27   E09000027     2610     2291     2647      207     2133     3337
## 28   E09000028        0     1194     3776     1889     1476     1937
## 29   E09000029     1255      201      755      545      146      278
## 30   E09000030     3251     4909    18057    17064    17494    14601
## 31   E09000031    17182    17049    17176    17361    12290    18459
## 32   E09000032     8226     5166     6674     4977     8547     9582
## 33   E09000033     8367     6636     6166     6380     3447     3876
## 34 Grand Total   149501   123680   165320   159636   140160   157679
##    X2017_18 Grand_Total
## 1      2579        7945
## 2      1066       14176
## 3       503        6541
## 4       327        3291
## 5      7483       31889
## 6       258        2712
## 7     12671       46667
## 8      2684        6339
## 9      5471       48696
## 10     5855       41104
## 11     1443       55484
## 12    11172       49415
## 13     2982       21721
## 14     3171       41725
## 15     1622        6409
## 16    10463       79263
## 17     4393       20453
## 18     4334       13889
## 19     7231       53303
## 20    10165       48541
## 21        3           3
## 22      959        1557
## 23     1330       11393
## 24     6299       25765
## 25     3615       55241
## 26     5670       36589
## 27     2615       15840
## 28     2255       12527
## 29      450        3630
## 30    13316       88692
## 31    17036      116553
## 32     9735       52907
## 33     7111       41983
## 34   166267     1062243</code></pre>
</div>
<div id="join-data-2" class="section level3">
<h3><span class="header-section-number">5.7.3</span> Join data</h3>
<p>In R we’ve given our London boroughs shapefile the name shape and our flytipping <code>.csv</code> the name mycsv. If you look in the Environment quadrant you should see them both listed.</p>
<p>Join the <code>.csv</code> to the shapefile. Here, replace Row.Labels with whatever your GSS_CODE is called in the <code>.csv</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tmap)
<span class="kw">library</span>(tmaptools)
shape &lt;-<span class="st"> </span><span class="kw">append_data</span>(shape, mycsv, <span class="dt">key.shp=</span><span class="st">&quot;GSS_CODE&quot;</span>, <span class="dt">key.data =</span> <span class="st">&quot;Row.Labels&quot;</span>)</code></pre>
<pre><code>## Over coverage: 1 out of 34 data records were not appended. Run over_coverage() to get the corresponding data row numbers and key values.</code></pre>
<p>Let’s break this down a bit. We just created a data frame (my.csv) where each coloumn has a variable and each row contains a set of values — so basically a normal table. The match simply found the GSS_CODE values in the <code>.csv</code> and joined the data to our shapefile.</p>
<p>The message detailing 1 out of the 34 data records were not appended refers to the Grand Total row within the <code>.csv</code>.</p>
<p>Check the merge was successful, this is just going to show the top 10 rows:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(shape, <span class="dt">n=</span><span class="dv">10</span>)</code></pre>
<pre><code>## Simple feature collection with 10 features and 15 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 198355.2
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.1502,0.247,0.8421,-20.4894 +units=m +no_defs
##                    NAME  GSS_CODE  HECTARES NONLD_AREA ONS_INNER SUB_2009
## 21 Kingston upon Thames E09000021  3726.117      0.000         F     &lt;NA&gt;
## 8               Croydon E09000008  8649.441      0.000         F     &lt;NA&gt;
## 6               Bromley E09000006 15013.487      0.000         F     &lt;NA&gt;
## 18             Hounslow E09000018  5658.541     60.755         F     &lt;NA&gt;
## 9                Ealing E09000009  5554.428      0.000         F     &lt;NA&gt;
## 16             Havering E09000016 11445.735    210.763         F     &lt;NA&gt;
## 17           Hillingdon E09000017 11570.063      0.000         F     &lt;NA&gt;
## 15               Harrow E09000015  5046.330      0.000         F     &lt;NA&gt;
## 5                 Brent E09000005  4323.270      0.000         F     &lt;NA&gt;
## 3                Barnet E09000003  8674.837      0.000         F     &lt;NA&gt;
##    SUB_2006 X2011_12 X2012_13 X2013_14 X2014_15 X2015_16 X2016_17 X2017_18
## 21     &lt;NA&gt;        0        0        0        0        0        0        3
## 8      &lt;NA&gt;       31      108      460      712     1707      637     2684
## 6      &lt;NA&gt;      306      479      653      462      326      228      258
## 18     &lt;NA&gt;     1234     1030      994     2190     1865     2242     4334
## 9      &lt;NA&gt;     6727     5679     6543     5521     6067    12688     5471
## 16     &lt;NA&gt;    13970    13762    13393     7404     8523    11748    10463
## 17     &lt;NA&gt;     5120     4188     3101        0      620     3031     4393
## 15     &lt;NA&gt;     1053        0        0      995     1354     1385     1622
## 5      &lt;NA&gt;     6713     2232     3189     3926     3980     4366     7483
## 3      &lt;NA&gt;     2356     1828      890      219      615      130      503
##    Grand_Total                       geometry
## 21           3 MULTIPOLYGON (((516401.6 16...
## 8         6339 MULTIPOLYGON (((535009.2 15...
## 6         2712 MULTIPOLYGON (((540373.6 15...
## 18       13889 MULTIPOLYGON (((521975.8 17...
## 9        48696 MULTIPOLYGON (((510253.5 18...
## 16       79263 MULTIPOLYGON (((549893.9 18...
## 17       20453 MULTIPOLYGON (((510599.8 19...
## 15        6409 MULTIPOLYGON (((510599.8 19...
## 5        31889 MULTIPOLYGON (((525201 1825...
## 3         6541 MULTIPOLYGON (((524579.9 19...</code></pre>
<p>Now, let’s make a quick thematic map (or a qtm) using the package <code>tmap</code>. I’ve made mine for flytipping between 2011 and 2012 (coloumn X2011_12):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tmap)
<span class="kw">library</span>(tmaptools)
<span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</code></pre>
<pre><code>## tmap mode set to plotting</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qtm</span>(shape, <span class="dt">fill =</span> <span class="st">&quot;X2011_12&quot;</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="export-data-2" class="section level3">
<h3><span class="header-section-number">5.7.4</span> Export data</h3>
<p>Finally write shape to a new GeoPackage (<code>.gpkg</code>) giving it the layer name of your choice:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_write</span>(shape, <span class="st">&quot;Prac1_data/Rwk1.gpkg&quot;</span>, <span class="st">&quot;london_boroughs_fly_tippint&quot;</span>, <span class="dt">delete_layer=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## Deleting layer `london_boroughs_fly_tippint&#39; using driver `GPKG&#39;
## Updating layer `london_boroughs_fly_tippint&#39; to data source `Prac1_data/Rwk1.gpkg&#39; using driver `GPKG&#39;
## features:       33
## fields:         15
## geometry type:  Multi Polygon</code></pre>
<p>So here, we are saying the shape is the object we want to save, then to the GeoPackage file path, with the layer name of london_boroughs_fly_tippint. I’ve set delete_layer to true so I could overwrite mine when I developed this practical. Changing it to false would generate an error message if you ever tried to re-run the code.</p>
<p>Let’s also add the <code>.csv</code> as we did in QGIS. This is a bit more complicated as we have to use the SQLite datavase package. Firstly, connect to the <code>.gpkg</code> we just made:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RSQLite)
con =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw">SQLite</span>(),<span class="dt">dbname=</span><span class="st">&quot;Prac1_data/Rwk1.gpkg&quot;</span>)</code></pre>
<p>Now examine what is in the <code>.gpkg</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbListTables</span>(con)</code></pre>
<pre><code>##  [1] &quot;gpkg_contents&quot;                                
##  [2] &quot;gpkg_extensions&quot;                              
##  [3] &quot;gpkg_geometry_columns&quot;                        
##  [4] &quot;gpkg_metadata&quot;                                
##  [5] &quot;gpkg_metadata_reference&quot;                      
##  [6] &quot;gpkg_ogr_contents&quot;                            
##  [7] &quot;gpkg_spatial_ref_sys&quot;                         
##  [8] &quot;gpkg_tile_matrix&quot;                             
##  [9] &quot;gpkg_tile_matrix_set&quot;                         
## [10] &quot;london_boroughs_fly_tippint&quot;                  
## [11] &quot;original_csv&quot;                                 
## [12] &quot;rtree_london_boroughs_fly_tippint_geom&quot;       
## [13] &quot;rtree_london_boroughs_fly_tippint_geom_node&quot;  
## [14] &quot;rtree_london_boroughs_fly_tippint_geom_parent&quot;
## [15] &quot;rtree_london_boroughs_fly_tippint_geom_rowid&quot; 
## [16] &quot;sqlite_sequence&quot;</code></pre>
<p>Then add add our <code>.csv</code> and disconnect from the <code>.gpkg</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbWriteTable</span>(con,<span class="st">&quot;original_csv&quot;</span>, mycsv, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)
<span class="kw">dbDisconnect</span>(con)</code></pre>
</div>
<div id="making-a-script" class="section level3">
<h3><span class="header-section-number">5.7.5</span> Making a script</h3>
<p>To convert this bit of analysis into a script that we could save and run again in future, I would write the following in the script quadrant:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;sf&quot;</span>, <span class="st">&quot;tmap&quot;</span>, <span class="st">&quot;tmaptools&quot;</span>, <span class="st">&quot;RSQLite&quot;</span>, <span class="dt">repos =</span> <span class="st">&quot;https://www.stats.bris.ac.uk/R/&quot;</span>)
<span class="kw">library</span>(sf, tmap, tmaptools, RSQLite)
shape &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;Prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>)
mycsv =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Prac1_data/fly_tipping_borough_edit.csv&quot;</span>)  
shape&lt;-<span class="kw">append_data</span>(shape, mycsv, <span class="dt">key.shp=</span><span class="st">&quot;GSS_CODE&quot;</span>, <span class="dt">key.data =</span> <span class="st">&quot;Row.Labels&quot;</span>)
<span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)
<span class="kw">qtm</span>(shape, <span class="dt">fill =</span> <span class="st">&quot;X2011_12&quot;</span>)
<span class="kw">st_write</span>(shape, <span class="st">&quot;Prac1_data/Rwk1.gpkg&quot;</span>, <span class="st">&quot;london_boroughs_fly_tippint&quot;</span>, <span class="dt">delete_layer=</span><span class="ot">TRUE</span>)
con =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw">SQLite</span>(),<span class="dt">dbname=</span><span class="st">&quot;Prac1_data/Rwk1.gpkg&quot;</span>)
<span class="kw">dbListTables</span>(con)
<span class="kw">dbWriteTable</span>(con,<span class="st">&quot;original_csv&quot;</span>, mycsv, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)
<span class="kw">dbDisconnect</span>(con)</code></pre>
<p>You can then save your script through File &gt; Save As.</p>
</div>
</div>
<div id="what-will-i-use-1" class="section level2">
<h2><span class="header-section-number">5.8</span> What will I use</h2>
<p>Well… it depends. If you wanted to quickly open a dataset to explore its contents then i’d use QGIS or ArcMap. However, if you had 100 raster images that you wanted to clip to your study area, i’d automate it in R. There are also specfic packages developed for each type of software that might dictate what you use, for example I recently made use of the Urban Multi-sacle Envrionmental Predictor (UMEP) plugin in QGIS. That said, as I needed to match different hourly meterological varaibles over a three year period I automated the first part of the analysis in R and loaded a <code>.csv</code> into QGIS.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-basics-of-geographic-information.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-sources-and-task.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-prac1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
